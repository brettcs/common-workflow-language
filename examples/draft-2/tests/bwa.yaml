class: CommandLineTool
label: bwa mem
requirements:
  - class: DockerRequirement
    dockerPull: http://images.sbgenomics.com/rabix/bwa:latest
  - class: ExpressionEngineRequirement
    id: "#js"
    expressionCommand: cwl-js-engine
    requirements: {"class": "DockerRequirement", "dockerPull": "rabix/js"}
inputs:
  - id: "#reference"
    type: File
    inputBinding:
      position: 1
  - id: "#reads"
    type:
      type: array
      items: File
    inputBinding:
      position: 2
  - id: "#minStdMaxMin"
    type: ["null", {"type": "array", "items": "int"}]
    inputBinding:
      prefix: -I
      separator: ","
outputs:
  - id: "#outfile"
    type: File
    outputBinding:
      glob: "*.bam"
stdout: output.bam
baseCommand: [bwa, mem]
arguments:
  - position: 0
    prefix: -t
    argValue:
      class: Expression
      engine: "#js"
      script: $job.allocatedResources.cpu
